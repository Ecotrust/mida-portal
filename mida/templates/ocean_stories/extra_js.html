{% load wagtailcore_tags static %}

<script src="{% static 'js/bookmarks.js' %}"></script>
<script src="{% static 'js/userlayers.js' %}"></script>
<script src="{% static 'js/scenarios.js' %}"></script>
<script src="{% static 'js/reports.js' %}"></script>

{% if MAP_LIBRARY %}
  <script src="{% static 'jquery-migrate/jquery-migrate.min.js' %}"></script>
  <script src="{% static 'jquery.bbq/jquery.ba-bbq.js' %}"></script>
  <script src="{% static 'js/lib/lodash.min.js' %}"></script>
  <script src="{% static 'js/lib/knockout-3.3.0.js' %}"></script>
  <script src="{% static 'js/lib/knockout.mapping-2.4.1.js' %}"></script>
  <script src="{% static 'js/knockout-bindings.js' %}"></script>

  {% if MAP_LIBRARY == 'ol8' %}
    <script src="{% static 'assets/openlayers/ol8/ol.js' %}" type="text/javascript"></script>
    <script src="{% static 'assets/ol-esri-style/vanilla/vanilla.js' %}" type="text/javascript"></script>
  {% endif %}

  <script src="/static/js/fixtures.js"></script>

  <script type="text/javascript">
    app.ARCGIS_API_KEY = '{{ ARCGIS_API_KEY}}';
    app.map_tech = '{{ MAP_LIBRARY }}';
    app.region = {{ REGION | safe }};
  </script>

  <script src="{% static 'js/wrappers/wrapper_init.js' %}"></script>
  <!-- LOAD MAP WRAPPERS -->
  <script src="{% static 'js/' %}wrappers/{{ MAP_LIBRARY }}/{{ MAP_LIBRARY }}_map_library.js"></script>
  <script src="{% static 'js/' %}wrappers/{{ MAP_LIBRARY }}/{{ MAP_LIBRARY }}_layers.js"></script>
  <script src="{% static 'js/' %}wrappers/{{ MAP_LIBRARY }}/{{ MAP_LIBRARY }}_wrapper.js"></script>
  <script src="{% static 'js/map.js' %}"></script>
  <script src="{% static 'js/' %}wrappers/{{ MAP_LIBRARY }}/{{ MAP_LIBRARY }}_map.js"></script>
  <script src="{% static 'js/models.js' %}"></script>
  <script src="{% static 'js/server.js' %}"></script>
  <script src="{% static 'js/' %}wrappers/{{ MAP_LIBRARY }}/{{ MAP_LIBRARY }}_state.js"></script>
  <script src="{% static 'js/state.js' %}"></script>
  <script src="{% static 'js/' %}wrappers/{{ MAP_LIBRARY }}/{{ MAP_LIBRARY }}_app.js"></script>
  <script src="{% static 'js/events.js' %}"></script>

  <script src="{% static 'portal/ocean_story/wrapper' %}/{{ MAP_LIBRARY }}/{{ MAP_LIBRARY }}_map_engine.js"></script>
  <script src="{% static 'portal/ocean_story' %}/curtain.js"></script>
  <script src="{% static 'portal/ocean_story' %}/scroll_spy.js"></script>
  <script src="{% static 'portal/ocean_story/wrapper' %}/index_wrapper.js"></script>

{% else %}

  <script src="{% static 'ol3-unofficial/ol.js' %}"></script>
  <script src="{% static 'bundles/ocean_story.js' %}"></script>

{% endif %}

<script type="text/javascript">
  $(document).ready(function() {
    oceanStory($('#map'), {{ self.as_json|safe }}, true);
  })
</script>
