{% extends "base.html" %}
{% load static wagtailcore_tags wagtailimages_tags wagtailcustom_tags %}

{% block extra_css %}
    {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% static 'portal/search_results.css' %}"/>
{% endblock %}

{% block content %}

<main class="search-page">
        <!-- Search Section -->
        <section class="search-section">
          <form action="/search/" method="get" class="search-form">
            <input class="search-box" type="search" name="q"{% if query_string %} value="{{ query_string }}"{% endif %} class="form-control search-input">
          </form>
        </section>

        <!-- Results Content -->
        <section class="results-content">
            <!-- Data Section -->
            <section class="result-section">
                <div class="section-header">
                    <p class="section-title">Data</p>
                    <p class="section-count">Results: {{ sum_data_results }}</p>
                </div>
                  {% for result in theme_results %}
                    <div class="result-item">
                      <p class="result-title">
                        <a href="/data-catalog/{{ result.name }}">{{ result.display_name }}</a>
                      </p>
                    </div>
                  {% endfor %}

                  {% for result in layer_results %}
                    <div class="result-item">
                      <p class="result-title">
                        <a href="{{ result.get_absolute_url }}">{{ result.name }}</a>
                      </p>
                    </div>
                  {% endfor %}

                  {% for result in data_needs_results %}
                    <div class="result-item">
                      <p class="result-title">
                        <a href="{{ result.specific.url }}">{{ result.specific }}</a>
                      </p>
                    </div>
                  {% endfor %}

                  {% for result in resources_results %}
                    <div class="result-item">
                      <p class="result-title">
                        <a href="{{ result.specific.url }}">{{ result.specific }}</a>
                      </p>
                    </div>
                  {% endfor %}
            </section>

            <!-- Ocean Stories Section -->
            <section class="result-section">
                <div class="section-header">
                    <p class="section-title">Ocean Stories</p>
                    <p class="section-count">Results: {{ ocean_story_results|length }}</p>
                </div>
                  {% for result in ocean_story_results %}
                    <div class="result-item">
                      <p class="result-title">
                        <a href="{{ result.specific.url }}">{{ result.specific }}</a>
                      </p>
                      <div class="result-description">
                        <span class="item-text">{{ result.description|anchored_richtext }}</span>
                      </div>
                    </div>
                  {% endfor %}
            </section>

            <!-- Calendar/News Events Section -->
            <section class="result-section">
                <div class="section-header">
                    <p class="section-title">Events</p>
                    <p class="section-count">Results: {{ calendar_news_results|length }}</p>
                </div>
                  {% for result in calendar_news_results %}
                    <div class="result-item">
                      <p class="result-title">
                        <a href="{{ result.specific.url }}">{{ result.specific }}</a>
                        {% if result.date %}
                          <span class="date">{{ result.date }}</span>
                        {% endif %}
                      </p>
                      {% if not result.date %}
                        <div class="result-description">
                          <span class="item-text">{{ result.description|anchored_richtext }}</span>
                        </div>
                      {% endif %}
                    </div>
                  {% endfor %}
            </section>
        </section>
    </main>
{% endblock %}

{% block extra_js %}
  <script>
    $('.content .search-box').focus();
  </script>
{% endblock %}
