<!-- mida/templates/calendar/calendar.html -->
{% extends "cms/base.html" %}
{% load static wagtailcore_tags wagtailimages_tags %}

{% block extra_css %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'mida/calendar/calendar.css' %}">
{% endblock extra_css %}

{% block content %}
    <div class="bg-light-blue contain contain-padded">
        <section class="calendar-grid" aria-label="Upcoming events">
            {% for item in self.events %}
                <article class="event-card">
                    {% if item.feature_image %}
                        <a class="event-card__media" href="{{ item.url }}">
                            {% image item.feature_image min-640x420 class="event-card__image" %}
                        </a>
                    {% endif %}

                    <div class="event-card__body">
                        <div class="event-card__meta">

                            {% if item.date %}
                                <div class="event-chip">
                                    <img src="{% static 'mida/calendar/img/marcodataportal-global-icon-calendar.svg' %}" alt="Calendar icon">
                                    <time datetime="{{ item.date|date:'c' }}">
                                        {{ item.date|date:"F j, Y" }}
                                    </time>
                                </div>
                            {% endif %}
                            
                            <div class="event-location">

                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="25" viewBox="0 0 18 25" fill="none">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M17.8567 8.92836C17.8567 12.8993 15.2644 16.2647 11.6799 17.4247H11.808L9.04787 24.121L6.16776 17.4247H6.17686C2.59228 16.2647 0 12.8993 0 8.92836C0 3.99736 3.99736 0 8.92836 0C13.8594 0 17.8567 3.99736 17.8567 8.92836ZM8.92955 15.8884C12.6941 15.8884 15.7458 12.8367 15.7458 9.07213C15.7458 5.30761 12.6941 2.25586 8.92955 2.25586C5.16503 2.25586 2.11328 5.30761 2.11328 9.07213C2.11328 12.8367 5.16503 15.8884 8.92955 15.8884Z" fill="#00A564"/>
                                </svg>

                                {% if item.location %}
                                    {{ item.location }}
                                {% else %}
                                    Virtual
                                {% endif %}

                            </div>

                        </div>

                        <h3 class="event-card__title">
                            <a href="{{ item.url }}">{{ item.title }}</a>
                        </h3>

                        {% if item.search_description or item.description %}
                            <p class="event-card__excerpt">
                                {% if item.search_description %}
                                    {{ item.search_description|striptags|truncatechars:226 }}
                                {% else %}
                                    {{ item.description|striptags|truncatechars:226 }}
                                {% endif %}
                            </p>
                        {% endif %}

                        <div class="event-card__actions">
                            <a class="button-small" href="{{ item.url }}">Learn more</a>
                        </div>
                    </div>
                </article>
            {% empty %}
                <p>No upcoming events right now.</p>
            {% endfor %}
        </section>
    </div>
{% endblock %}