{% extends "cms/section.html" %}
{% load static wagtailcore_tags wagtailimages_tags %}

{% block extra_css %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'mida/calendar/calendar.css' %}">
{% endblock extra_css %}

{% block content %}
    <div class="bg-light-blue contain contain-padded">
        <section class="calendar-grid" aria-label="Upcoming events">
            {% for item in self.events %}
                <article class="event-card">
                    {% if item.feature_image %}
                        <a class="event-card__media" href="{{ item.url }}">
                            {% image item.feature_image fill-640x420 class="event-card__image" %}
                        </a>
                    {% endif %}

                    <div class="event-card__body">
                        <div class="event-card__meta">
                            {% if item.location %}
                                <span class="event-chip">{{ item.location }}</span>
                            {% endif %}
                            {% if item.event_date %}
                                <time class="event-chip" datetime="{{ item.event_date|date:'c' }}">
                                    {{ item.event_date|date:"F j, Y" }}
                                </time>
                            {% endif %}
                            {% if item.event_type %}
                                <span class="event-tag">{{ item.event_type }}</span>
                            {% else %}
                                <span class="event-tag">Event</span>
                            {% endif %}
                        </div>

                        <h3 class="event-card__title">
                            <a href="{{ item.url }}">{{ item.title }}</a>
                        </h3>

                        {% if item.search_description or item.description %}
                            <p class="event-card__excerpt">
                                {% if item.search_description %}
                                    {{ item.search_description|striptags }}
                                {% else %}
                                    {{ item.description|striptags }}
                                {% endif %}
                            </p>
                        {% endif %}

                        <div class="event-card__actions">
                            <a class="button-ghost" href="{{ item.url }}">Learn more</a>
                        </div>
                    </div>
                </article>
            {% empty %}
                <p>No upcoming events right now.</p>
            {% endfor %}
        </section>
    </div>
{% endblock %}